---
interface CapabilityItem {
  area: string;
  depth: number;
}

const { capabilities } = Astro.props as { capabilities: CapabilityItem[] };
const columns = [1, 2, 3, 4, 5];
---
<section class="flex flex-col gap-6" id="capabilities-map">
  <div class="flex flex-col gap-2">
    <span class="text-xs font-semibold uppercase tracking-[0.32em] text-[color:var(--ink-2)]">Platform</span>
    <h2 class="text-lg font-semibold text-[color:var(--ink)]">Capabilities Map</h2>
    <p class="max-w-2xl text-sm text-[color:var(--ink-2)]">Depth map across CRO, SEO, IA, analytics, and platform craft. Each cell is keyboard focusable with descriptive labels.</p>
  </div>
  <div role="grid" aria-label="Capabilities depth" class="overflow-hidden rounded-[var(--r-3)] border border-[color:color-mix(in_srgb,var(--ink)_14%,transparent)]">
    <div class="grid grid-cols-[minmax(160px,1fr)_repeat(5,minmax(60px,1fr))] bg-[color:color-mix(in_srgb,var(--surface)_94%,transparent)] text-xs uppercase tracking-[0.24em] text-[color:var(--ink-2)]">
      <div class="px-4 py-3">Discipline</div>
      {columns.map((column) => (
        <div class="px-4 py-3 text-center">{column}</div>
      ))}
    </div>
    <div class="divide-y divide-[color:color-mix(in_srgb,var(--ink)_12%,transparent)] bg-[color:color-mix(in_srgb,var(--surface-alt)_96%,transparent)]" role="rowgroup">
      {capabilities.map((item) => (
        <div role="row" class="grid grid-cols-[minmax(160px,1fr)_repeat(5,minmax(60px,1fr))]">
          <div role="rowheader" class="px-4 py-3 text-sm font-semibold text-[color:var(--ink)]">{item.area}</div>
          {columns.map((column) => (
            <button
              key={column}
              type="button"
              role="gridcell"
              class={[
                "flex items-center justify-center border-l border-[color:color-mix(in_srgb,var(--ink)_8%,transparent)] px-2 py-3 text-sm transition-colors duration-150 ease-[cubic-bezier(.2,.8,.2,1)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-1 focus-visible:outline-[color:var(--accent)]",
                column <= item.depth
                  ? "bg-[color:color-mix(in_srgb,var(--accent)_14%,transparent)] text-[color:var(--ink)]"
                  : "text-[color:var(--ink-2)]"
              ].join(" ")}
              aria-label={`${item.area} depth ${column} of 5`}
            >
              {column <= item.depth ? "●" : "○"}
            </button>
          ))}
        </div>
      ))}
    </div>
  </div>
</section>
