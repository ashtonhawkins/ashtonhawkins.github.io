---
import tags from '@data/writing-tags.json';

const TAGS = tags.slice(0, 20);
const sizes = ['10px', '11px', '13px', '15px', '17px', '20px'];
const laneCount = Math.min(TAGS.length, 12);
const laneHeight = 100 / laneCount;
const seededTags = TAGS.map((tag, index) => ({
  tag,
  lane: index % laneCount,
  duration: 20 + Math.random() * 35,
  delay: -(Math.random() * (20 + Math.random() * 35)),
  size: sizes[index % sizes.length]
}));
---
<div class="words-drift" aria-label="Writing topics">
  {seededTags.map((item) => (
    <a href={`/writing?tag=${encodeURIComponent(item.tag)}`} class="words-drift__tag" style={`--top:${item.lane * laneHeight + laneHeight * 0.2}%; --dur:${item.duration}s; --delay:${item.delay}s; --size:${item.size};`}>{item.tag}</a>
  ))}
</div>
<style>
.words-drift{position:relative;height:230px;overflow:hidden;background:var(--surface-secondary);isolation:isolate}
.words-drift::before,.words-drift::after{content:'';position:absolute;top:0;bottom:0;width:40px;z-index:5;pointer-events:none}
.words-drift::before{left:0;background:linear-gradient(to right,var(--surface-primary),transparent)}
.words-drift::after{right:0;background:linear-gradient(to left,var(--surface-primary),transparent)}
.words-drift__tag{position:absolute;left:-10%;top:var(--top);font-family:'IBM Plex Mono',monospace;font-size:var(--size);text-decoration:none;color:var(--text-tertiary);white-space:nowrap;animation:drift-left-to-right var(--dur) linear var(--delay) infinite;transition:color .2s ease;cursor:pointer}
.words-drift__tag:hover{color:var(--accent-primary)}
@keyframes drift-left-to-right{from{transform:translateX(-100%);left:-10%}to{transform:translateX(0);left:110%}}
@media (prefers-reduced-motion: reduce){.words-drift{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:.5rem;height:auto;padding:1rem}.words-drift__tag{position:static;animation:none;left:auto;top:auto;transform:none}}
</style>
