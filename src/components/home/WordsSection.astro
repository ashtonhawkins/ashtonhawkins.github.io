---
import SectionHeader from '@components/ui/SectionHeader.astro';
import WritingDrift from '@components/home/WritingDrift.astro';
import StatusChip from '@components/ui/StatusChip.astro';
import feeds from '@data/feeds-cache.json';

const posts = ((feeds as any)?.items?.x ?? []).slice(0, 5);
---
<section class="writing-section">
  <SectionHeader label="Words" />
  <div class="writing-layout">
    <WritingDrift />
    <aside class="x-sidebar">
      <h3>// X <svg width="12" height="12" viewBox="0 0 12 12" aria-hidden="true"><path d="M2 2 L10 10 M10 2 L2 10" stroke="currentColor"/></svg></h3>
      <ul>
        {posts.length ? posts.map((post: any) => (
          <li>
            <p>{String(post.text ?? post.title ?? 'No text').slice(0, 180)}</p>
            <span>{post.relativeTime ?? post.timeAgo ?? '—'}</span>
          </li>
        )) : <li><p>No recent posts cached.</p><StatusChip label="OFFLINE" /></li>}
      </ul>
      <a href="https://x.com/" target="_blank" rel="noreferrer">@handle →</a>
    </aside>
  </div>
  <p class="writing__footer"><a href="/writing">VIEW ALL POSTS →</a></p>
</section>
<style>
.writing-layout{display:grid;gap:1rem}
.x-sidebar{border:1px solid var(--border);padding:.8rem;background:var(--surface-primary)}
.x-sidebar h3{margin:0 0 .6rem;display:flex;align-items:center;gap:.3rem;font:700 .76rem 'IBM Plex Mono',monospace;letter-spacing:.08em}
.x-sidebar ul{list-style:none;margin:0;padding:0}.x-sidebar li{padding:.55rem 0;border-bottom:1px solid color-mix(in srgb,var(--border) 70%,transparent)}
.x-sidebar p{margin:0;font:.85rem/1.35 'IBM Plex Sans',sans-serif;color:var(--text-primary);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.x-sidebar span{font:.68rem 'IBM Plex Mono',monospace;color:var(--text-tertiary);text-transform:uppercase}
.x-sidebar a,.writing__footer a{text-decoration:none;font:.72rem 'IBM Plex Mono',monospace;color:var(--text-secondary);letter-spacing:.08em}
@media (width >= 60rem){.writing-layout{grid-template-columns:1fr 1fr;align-items:start}}
</style>
