---
import SectionHeader from '@components/ui/SectionHeader.astro';
import NoiseTexture from '@components/ui/NoiseTexture.astro';
import StatusChip from '@components/ui/StatusChip.astro';
import TravelCardCanvas from '@components/home/TravelCardCanvas.astro';
import travelData from '@data/travel.json';
import superlativesData from '@data/travel-superlatives.json';
import travelStats from '@data/travel-stats.json';

const sketchByCategory: Record<string, string> = {
  'Fork & Knife': `<svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="var(--accent-primary)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"><ellipse cx="20" cy="22" rx="12" ry="11" /><ellipse cx="20" cy="22" rx="7" ry="6.5" /><path d="M4,8 L4,18 Q4,22 7,22 L7,35" /><line x1="2" y1="8" x2="2" y2="14" /><line x1="6" y1="8" x2="6" y2="14" /><path d="M36,8 Q38,14 36,20 L34,20 L34,35" /></svg>`,
  'Check-In': `<svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="var(--accent-primary)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"><path d="M6,30 L6,12 Q6,8 10,8 L30,8 Q34,8 34,12 L34,30" /><path d="M3,30 L37,30 L37,35 L3,35 Z" /><path d="M10,14 Q10,12 14,12 L20,12 Q24,12 24,14 L24,18 Q24,20 20,20 L14,20 Q10,20 10,18 Z" /><path d="M6,25 L34,25" /></svg>`,
  'Guilty Pleasure': `<svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="var(--accent-primary)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"><circle cx="20" cy="14" r="8" /><path d="M12,18 L20,38 L28,18" /><path d="M13,16 Q11,20 12,24" /><path d="M27,15 Q29,20 27,26" /><line x1="16" y1="22" x2="24" y2="22" /><line x1="17" y1="26" x2="23" y2="26" /></svg>`,
  Splurge: `<svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="var(--accent-primary)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"><path d="M8,15 L8,36 L32,36 L32,15 Z" /><path d="M14,15 Q14,6 20,6 Q26,6 26,15" /><circle cx="28" cy="12" r="3" /><line x1="28" y1="15" x2="28" y2="18" /><path d="M12,15 Q16,10 20,15 Q24,10 28,15" /></svg>`,
  'Peak Transit': `<svg viewBox="0 0 40 40" width="40" height="40" fill="none" stroke="var(--accent-primary)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"><path d="M4,30 L4,14 Q4,10 8,10 L32,10 Q36,10 36,14 L36,30 Z" /><path d="M8,10 Q8,6 14,6 L26,6 Q32,6 32,10" /><rect x="8" y="14" width="8" height="6" rx="1" /><rect x="24" y="14" width="8" height="6" rx="1" /><rect x="17" y="14" width="6" height="12" rx="1" /><circle cx="12" cy="33" r="3" /><circle cx="28" cy="33" r="3" /><line x1="0" y1="36" x2="40" y2="36" /></svg>`
};
---
<section class="travel" data-travel data-cities={JSON.stringify(travelData)}>
  <SectionHeader label="Travel" />
  <article class="travel-card" data-travel-card>
    <TravelCardCanvas />
    <NoiseTexture opacity={0.03} />
    <div class="travel-card__info" data-travel-content>
      <h3 data-travel-city>{travelData[0].place}</h3>
      <p class="country" data-travel-country>{travelData[0].country}</p>
      <StatusChip label={`×${travelData[0].visits}`} active />
      <p class="route" data-travel-route>{travelData[0].routes?.[0] ?? 'SFO → ---'}</p>
    </div>
  </article>
  <p class="travel__stats">TOTAL FLIGHTS: {travelStats.totalFlights} · AIRPORTS: {travelStats.airports} · COUNTRIES: {travelStats.countries} · DISTANCE: {travelStats.totalDistance.toLocaleString()} MI</p>
  <div class="travel__supers">{superlativesData.superlatives.map((item) => <article class="plaque"><Fragment set:html={sketchByCategory[item.category] ?? sketchByCategory['Fork & Knife']} /><p>{item.category}</p><strong>{item.value}</strong><span>{item.place}</span></article>)}</div>
  <p class="travel__footer"><a href="/travel">EXPLORE ALL TRIPS →</a></p>
</section>
<style>
.travel-card{position:relative;min-height:250px;border:1px solid var(--border);overflow:hidden;margin-bottom:.75rem;background:var(--surface-primary)}
.travel-card__info{background: rgba(var(--surface-primary-rgb), 0.6);backdrop-filter: blur(4px);padding: 1rem;border-radius: 4px;position: relative;z-index: 5;display:grid;gap:.4rem;max-width:280px;transition:opacity .3s ease;margin:1rem}
.travel-card__info.is-fading{opacity:0}.travel-card h3{margin:0;font:700 1.25rem 'Space Grotesk Variable',sans-serif;letter-spacing:.06em;text-transform:uppercase}
.country,.route{margin:0;font:.72rem 'IBM Plex Mono',monospace;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.08em}
.travel__stats{font:.72rem 'IBM Plex Mono',monospace;text-transform:uppercase;color:var(--text-secondary);letter-spacing:.08em}
.travel__supers{display:grid;gap:.7rem;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));margin-top:.75rem}
.plaque{border:1px solid var(--border);padding:1rem;text-align:center}
.plaque p{margin:.45rem 0 .2rem;font:10px 'IBM Plex Mono',monospace;text-transform:uppercase;color:var(--text-secondary);letter-spacing:.1em}
.plaque strong{display:block;font:600 .9rem 'IBM Plex Sans',sans-serif;color:var(--text-primary)}.plaque span{font:10px 'IBM Plex Mono',monospace;color:var(--text-tertiary)}
.travel__footer a{text-decoration:none;font:.72rem 'IBM Plex Mono',monospace;color:var(--text-secondary)}
</style>
<script>
// @ts-nocheck
const root=document.querySelector('[data-travel]'); const content=document.querySelector('[data-travel-content]'); const cityEl=document.querySelector('[data-travel-city]'); const countryEl=document.querySelector('[data-travel-country]'); const routeEl=document.querySelector('[data-travel-route]'); const bg=document.querySelector('[data-travel-bg]');
if(root&&content&&cityEl&&countryEl&&routeEl&&bg){const cities=JSON.parse(root.dataset.cities??'[]'); let i=0; const render=()=>{const c=cities[i%cities.length]; cityEl.textContent=c.place; countryEl.textContent=c.country; routeEl.textContent=c.routes?.[0]??'SFO → ---'; const chip=content.querySelector('.status-chip__label'); if(chip) chip.textContent=`×${c.visits}`; bg.dispatchEvent(new CustomEvent('travel-city-change',{detail:{city:c.place}}));}; render();
if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){setInterval(()=>{content.classList.add('is-fading'); setTimeout(()=>{i=(i+1)%cities.length; render(); content.classList.remove('is-fading')},300)},12000)} }
</script>
