---
import printHref from "../styles/print.css?url";
const { title } = Astro.props;
const themeInit = `(() => {
  try {
    const stored = localStorage.getItem('theme');
    const system = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = stored ? stored : system ? 'dark' : 'light';
    if (theme === 'dark') document.documentElement.classList.add('dark');
    else document.documentElement.classList.remove('dark');
    document.documentElement.style.setProperty('color-scheme', theme === 'dark' ? 'dark light' : 'light dark');
  } catch (e) {}
})();`;
const confidentialInit = `(() => {
  try {
    const params = new URLSearchParams(window.location.search);
    const forced = params.get('mode');
    const key = 'resume_confidential';
    const stored = localStorage.getItem(key);
    let mode = 'confidential';
    if (forced === 'public' || forced === 'confidential') {
      mode = forced;
      localStorage.setItem(key, mode);
    } else if (stored === 'public' || stored === 'confidential') {
      mode = stored;
    } else {
      localStorage.setItem(key, mode);
    }
    document.documentElement.dataset.confidential = mode;
  } catch (e) {
    document.documentElement.dataset.confidential = 'confidential';
  }
})();`;
---
<!DOCTYPE html>
<html lang="en" data-confidential="confidential">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>{title}</title>
    <style>
      :root {
        --ink: #0b0b0f;
        --ink-2: #4a4a57;
        --surface: #f6f6f8;
        --surface-alt: #ffffff;
        --accent: #3b6ef5;
        color-scheme: light dark;
      }
      .dark {
        --ink: #f8f8fb;
        --ink-2: #a9a9c5;
        --surface: #0b0b0f;
        --surface-alt: #161621;
        --accent: #7da7ff;
        color-scheme: dark light;
      }
      body {
        font-family: "Inter", "system-ui", sans-serif;
        background: var(--surface);
        color: var(--ink);
        min-height: 100vh;
      }
      ::selection {
        background: color-mix(in srgb, var(--accent) 40%, transparent);
        color: var(--surface);
      }
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
          animation-duration: 1ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 1ms !important;
          scroll-behavior: auto !important;
        }
      }
    </style>
    <script is:inline>{themeInit}</script>
    <script is:inline>{confidentialInit}</script>
    <link rel="stylesheet" href={printHref} media="print" />
  </head>
  <body class="antialiased bg-[var(--surface)] text-[var(--ink)]">
    <slot />
  </body>
</html>
