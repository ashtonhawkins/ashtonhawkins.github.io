---
import Base from '@layouts/Base.astro';
import '@styles/coming-soon.css';
---

<Base
  title="Ashton Hawkins — Coming Soon"
  description="New site loading. Ashton Hawkins — web experience, optimization, and digital operations."
  robots="noindex"
>
  <main class="coming-shell" aria-label="System terminal boot experience">
    <canvas class="noise-canvas" id="noise-canvas" aria-hidden="true"></canvas>

    <section class="cs-center">
      <div class="cs-terminal" id="boot-sequence" aria-live="polite"></div>
    </section>

    <button class="cs-hint" id="terminal-hint" type="button">PRESS / TO ACCESS TERMINAL</button>

    <section class="cs-shell" id="command-shell" aria-label="Command terminal">
      <div class="cs-history" id="terminal-history"></div>
      <label class="cs-input-wrap" id="terminal-input-wrap" hidden>
        <span class="cs-prompt">&gt;</span>
        <input class="cs-input" id="terminal-input" type="text" autocapitalize="off" autocomplete="off" spellcheck="false" />
      </label>
    </section>
  </main>
</Base>

<script>
  import { initNoiseShader } from '@components/animations/NoiseShader';
  import { initBootSequence } from '@components/coming-soon/BootSequence';
  import { initTerminal } from '@components/coming-soon/Terminal';

  const canvas = document.querySelector<HTMLCanvasElement>('#noise-canvas');
  const bootContainer = document.querySelector<HTMLElement>('#boot-sequence');
  const hint = document.querySelector<HTMLElement>('#terminal-hint');
  const shell = document.querySelector<HTMLElement>('#command-shell');
  const history = document.querySelector<HTMLElement>('#terminal-history');
  const inputWrap = document.querySelector<HTMLElement>('#terminal-input-wrap');
  const input = document.querySelector<HTMLInputElement>('#terminal-input');

  if (canvas && bootContainer && hint && shell && history && inputWrap && input) {
    initNoiseShader(canvas);
    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
      hint.textContent = 'TAP HERE TO ACCESS TERMINAL';
    }
    initBootSequence(bootContainer, () => {}).then((boot) => {
      initTerminal({ shell, history, inputWrap, input, hint }, boot);
    });
  }
</script>
